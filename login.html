<!doctype html>
<html lang="en" class="h-100">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="icon" type="image/png" href="img/ic.png" />
    <title>Login - OLDRBX</title>
    <meta name="description" content="Relive 2020 for free, no invite keys required. The most secure and private website of its kind." />
    <meta name="twitter:card" content="summary" />
    <meta property="og:site_name" content="OLDRBX" />
    <meta property="og:url" content="https://OLDRBX.lol" />
    <meta property="og:title" content="Login" />
    <meta property="og:description" content="Relive 2020 for free, no invite keys required. The most secure and private website of its kind." />
    <meta property="og:image" content="https://OLDRBX.lol/img/OLDRBXC.png" />
    <style>
        body {
        background-color: #0c0c0cff !important;
        color: #ffffff !important;
        }
        .navbar.bg-dark {
            background-color: #0b0b0b !important;
            border-bottom: 2px solid #3d3d3dff !important;
        }
        .navbar.bg-light {
            background-color: #121212 !important;
            border-bottom: none !important;
        }
        .navbar-dark .navbar-nav .nav-link {
            color: #bbbbbbb0 !important;
        }
        .navbar-dark .navbar-nav .nav-link:hover {
            color: #ffffff !important;
        }
        .navbar-auth .nav-link {
            color: #bbbbbbb0 !important;
        }
        .navbar-auth .nav-link:hover {
            color: #ffffff !important;
        }
        footer.bg-dark {
            background-color: #0b0b0b !important;
            border-top: 2px solid #3d3d3dff !important;
        }
        footer .text-muted {
            color: #3d3d3dff !important;
        }
        .exchcont {
            max-width: 420px;
            margin: 50px auto;
        }
        .exchcard {
            background-color: #121212;
            border: 1px solid #2a2a2a;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.05);
            padding: 25px;
        }
        .exchcard h2 {
            text-align: center;
            margin-bottom: 20px;
            font-weight: 700;
            color: #ffffff;
        }
        .exchcard p {
            color: #ffffff;
            font-size: 0.95rem;
        }
        .exchcard .text-success,
        .exchcard .text-danger {
            text-align: center;
            margin-bottom: 10px;
        }
        .exchcard .form-control {
            background-color: #1b1b1b;
            color: #ffffff;
            border: 1px solid #3a3a3a;
            border-radius: 5px;
            padding: 8px;
            width: 100%;
            margin-top: 10px;
        }
            .exchcard .form-control:focus {
                background-color: #1e1e1e;
                border-color: #1a73e8;
                box-shadow: 0 0 0 0.2rem rgba(26, 115, 232, 0.25);
                color: #ffffff;
            }
        .exchcard label {
            font-weight: 600;
            margin-top: 10px;
        }
        .exchcard .btn-primary {
            background-color: #1a73e8;
            border-color: #1a73e8;
            color: #fff;
            width: 100%;
            margin-top: 15px;
            transition: all 0.2s ease-in-out;
        }
            .exchcard .btn-primary:hover {
                background-color: #155ab6;
                border-color: #155ab6;
            }
    .alert-warning {
        background-color: #2a2200;
        color: #ffcc00;
        border: 1px solid #ffcc00;
        margin-bottom: 20px;
    }
    .h-captcha {
        display: flex;
        justify-content: center;
        margin-top: 15px;
        margin-bottom: 15px;
    }
    .exchcard a {
        color: #1a73e8 !important;
        text-decoration: underline;
    }
        .exchcard a:hover {
            color: #63a4ff !important;
        }
    </style>
</head>
<body class="d-flex flex-column h-100">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom">
    <div class="container-fluid">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="home.html">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="login.html">Login</a></li>
                <li class="nav-item"><a class="nav-link" href="tos.html">Terms of Service</a></li>
                <li class="nav-item"><a class="nav-link" href="privacy.html">Privacy</a></li>
            </ul>
        </div>
    </div>
</nav>

<main class="flex-shrink-0">
<div class="exchcont">
    <div class="alert alert-warning">
        <p class="mb-0">
            <span class="fw-bolder">Warning:</span> No application ID is set.
            If your application was approved, you can ignore this message.
        </p>
    </div>

    <div class="exchcard">
        <h2>Login</h2>

        <p class="text-center">
            If you do not have an account, you can create one
            <a href="application.html">here</a>.
        </p>

        <form id="realLoginForm" method="post">
            <input id="username" type="text" placeholder="Username" name="username" class="form-control" />
            <input id="password" type="password" placeholder="Password" name="password" class="form-control" />
            <p class="text-center mt-2"><a href="#">Reset Password</a></p>
            <div class="h-captcha" data-sitekey="1b42e17a-9bb0-42f2-a5d8-d6aa0c6a3b88" data-theme="dark"></div>
            <input name="__RequestVerificationToken" type="hidden" value="static-token" />
            <input id="submitBtn" class="btn btn-primary" type="submit" value="Login" />
        </form>
        <div id="msg" style="margin-top:12px"></div>
    </div>
</div>
</main>

<footer class="footer mt-auto py-3 bg-dark">
    <div class="container">
        <p class="text-muted text-center">This website is not affiliated, endorsed, and/or sponsored by any companies, trademarks, or copyrighted names mentioned. No copyright infringement is intended.</p>
        <p class="text-muted mb-0 text-center">&copy; 2026 OLDRBX</p>
    </div>
</footer>

<script src="https://js.hcaptcha.com/1/api.js" async defer></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const SUPA_URL = "https://nkvvnnjukqtfhmegyzek.supabase.co";
  const SUPA_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5rdnZubmp1a3F0ZmhtZWd5emVrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg2NjQ5MTIsImV4cCI6MjA4NDI0MDkxMn0.2jp9X2KQunFargrstYM7oGBYs75Kq7AEHs7iRARxexs";
  let sb;
  try { sb = supabase.createClient(SUPA_URL, SUPA_KEY); } catch(e){ sb = null; }
  function sha256Hex(str){ const enc=new TextEncoder().encode(str); return crypto.subtle.digest("SHA-256",enc).then(buf=>{const b=new Uint8Array(buf); return Array.from(b).map(x=>x.toString(16).padStart(2,"0")).join("");});}
  function randToken(len){ const a=new Uint8Array(len); crypto.getRandomValues(a); return Array.from(a).map(b=>b.toString(16).padStart(2,"0")).join("");}
  function displayMsg(type, text) {
    const m = document.getElementById("msg");
    if (type === 'success') m.innerHTML = '<div class="alert alert-success text-center">' + text + '</div>';
    else if (type === 'info') m.innerHTML = '<div style="color:#8f8f8f;margin-bottom:8px;text-align:center">' + text + '</div>';
    else m.innerHTML = '<div class="alert alert-danger text-center">' + text + '</div>';
  }
  document.getElementById("realLoginForm").addEventListener("submit", async function(e){
    e.preventDefault();
    document.getElementById("msg").innerHTML = "";
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value;
    if(!username || !password){ displayMsg("error","Fill all fields"); return; }
    const captchaTextarea = document.querySelector('textarea[name="h-captcha-response"]');
    const captchaVal = captchaTextarea ? captchaTextarea.value : "";
    if(!captchaVal){ displayMsg("error","Please complete the captcha"); return; }
    const hash = await sha256Hex(password);
    let ok = false;
    if(sb){
      try{
        const res = await sb.from('users').select('id,password_hash,username').eq('username', username).limit(1);
        if(!res.error && res.data && res.data.length){
          const row = res.data[0];
          if(row.password_hash && row.password_hash === hash) ok = true;
        }
      }catch(e){}
    }
    if(!ok){
      try{
        const loc = JSON.parse(localStorage.getItem('localUsers')||'{}');
        if(loc[username] && loc[username] === hash) ok = true;
      }catch(e){}
    }
    if(ok){
      const token = randToken(16);
      localStorage.setItem('auth', JSON.stringify({username: username, token: token, ts: Date.now()}));
      displayMsg("success","Login successful. Redirecting...");
      setTimeout(()=>{ location.href = "web/home.html"; }, 350);
    } else {
      displayMsg("error","Invalid username or password");
    }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>

